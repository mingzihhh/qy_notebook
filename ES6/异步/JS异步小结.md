## JS异步小结

### 回调函数

**优点**：简单、容易理解和部署，解决了同步的问题

**缺点**：回调地狱，不利于代码的阅读和维护

回调地狱的根本问题在于：

- 缺乏顺序性： 回调地狱导致的调试困难，和大脑的思维方式不符
- 嵌套函数存在耦合性，一旦有所改动，就会牵一发而动全身，即**控制反转**
- 嵌套函数过多的多话，很难处理错误



### Promise

Promise 实现了链式调用，也就是说每次 then 后返回的都是一个全新 Promise，如果我们在 then 中 return ，return 的结果会被 Promise.resolve() 包装

**优点**：解决了回调地狱的问题

**缺点**：无法取消 Promise ，错误需要通过回调函数来捕获



####  Generator

**特点：可以控制函数的执行**，可以配合 co 函数库使用



####  Async/await

async、await 是异步的终极解决方案

**优点**：代码清晰，不用像 Promise 写一大堆 then 链，处理了回调地狱的问题

**缺点**：await 将异步代码改造成同步代码，如果多个异步操作没有依赖性而使用 await 会导致性能上的降低。

```
async function test() {
  // 以下代码没有依赖性的话，完全可以使用 Promise.all 的方式
  // 如果有依赖性的话，其实就是解决回调地狱的例子了
  await fetch('XXX1')
  await fetch('XXX2')
  await fetch('XXX3')
}
```

