## 网络基础

### OSI 7层结构

<https://juejin.im/post/5a98e1f7f265da237410694e>

##### 7.应用层(Application)

dns，http（主要解决如何包装数据）， ftp，dhcp, pop3， smtp

##### 6.表示层(Presentation)

数据的转换，压缩和加密，SSL

##### 5.会话层(Session)

两个应用程序进程之间的逻辑连接，两个应用程序通过这个逻辑连接在一段时间内交换数据。

管理确定传输方式，单向，半双工，全双工

##### 4.传输层(Transport)

主要解决数据如何在网络中传输

tcp， udp

##### 3.网络层(Network)    -- 路由器

如何把数据从一个设备发送到另一个设备，地址，路由，分段，重组

ip协议

##### 2.数据链路层(Data Link) -- 交换机

如何把数据发送到本地网络中去

数据链路层通过MAC地址来确保数据能够正确被发送到目标设备。

##### 1.物理层(Physical) -- 网卡、集线器（Hub）

硬件规范，编码信号



### TCP(Transmission Control Protocol，传输控制协议)

- 面向连接

- 提供可靠的数据传输

- 面向字节流。根据对方给出的窗口值和网络拥塞程度，决定一个TCP段应包含多少个字节。

- 只支持一对一

  

### UDP(User Datagram Protocol，用户数据报协议)

- 无连接
- 尽最大努力交付，不提供可靠的数据传输
- 面向报文。UDP只是把应用程序发给它的数据打包成一个UDP数据报（UDP Datagram），然后再把这个数据报传给IP。报文长度由应用程序给出，报文长度过大会导致ip层分片，降低效率。
- 支持一对一，一对多，多对一的交互通信
- 没有拥塞控制，适合实时应用



### TCP中的一些机制

**可靠传输**：连续ARQ（自动重传请求）协议

>确认重传机制，序号，超时计时器，累积确认，滑动窗口

**流量控制**（端对端）：根据接收窗口数值（tcp首部），控制发送方的滑动窗口大小

**拥塞控制**（全局性）：发送方控制拥塞窗口大小，拥塞窗口大小取决于网络拥塞程度

>可以通过丢弃分组百分比，超时重传分组数和平均分组时延等来判断拥塞

发送窗口 = min（接收窗口，拥塞窗口）

- **慢开始**：从1开始，每经过一个RTT，cwnd加倍；网络拥塞后，慢开始门限减半，从1开始
- **拥塞避免**：到达慢开始门限，每经过一个RTT，cwnd加1
- **快重传**：接收方每收到一个失序的报文段，立刻发出重复确认，不要等待捎带确认；发送方收到3个重复确认，立刻重传接收方未收到的报文，不用等重传计时器到期
- **快恢复**（预防拥塞）：发送方收到3个重复确认，慢开始门限减半，将cwnd设为慢开始门限大小，执行拥塞避免算法



