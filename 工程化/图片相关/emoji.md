## Unicode

Unicode æ˜¯ä¸€ç§ç”µè„‘ç¼–ç ç³»ç»Ÿï¼Œå®ƒè¯•å›¾ä¸ºä¸–ç•Œä¸Šæ‰€æœ‰æ–‡æœ¬å­—ç¬¦æä¾›å”¯ä¸€çš„æ•°å­—è¡¨ç¤ºã€‚åœ¨unicodeè¿˜æ²¡æœ‰é—®ä¸–å‰ï¼Œè‹±è¯­å›½å®¶ä½¿ç”¨çš„ç¼–ç è§„åˆ™æ˜¯ASCIIï¼Œä½†æ˜¯äºšæ´²è®¸å¤šå›½å®¶ï¼Œæ¯”å¦‚ä¸­å›½ï¼Œåˆæœ‰è‡ªå·±çš„ç¼–ç è§„åˆ™ï¼Œå¦‚GB2312ã€‚å„å›½ä¹‹é—´ä¼ è¾“æ–‡ä»¶ä¸€å®šä¼šå› æ­¤å‡ºçŽ°ä¹±ç çš„é—®é¢˜ã€‚è€ŒUnicodeçš„å‡ºçŽ°å¸®æˆ‘ä»¬ç»Ÿä¸€äº†è¿™äº›è§„åˆ™ã€‚

ä¸ç®¡æ˜¯å“ªç§è¯­è¨€ã€å“ªç§ç¬¦å·ï¼ŒUnicode éƒ½æä¾›äº†ä¸€ç§æ–¹æ³•æ¥å°†å®ƒä»¬è½¬æ¢ä¸ºæ•°å­—ç ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥åœ¨è®¡ç®—æœºå’Œäº’è”ç½‘ä¸Šä½¿ç”¨ã€‚

### ç ç‚¹

Unicode è§„å®šäº†æ¯ä¸ªå­—ç¬¦çš„æ•°å­—ç¼–å·ï¼Œè¿™ä¸ªç¼–å·è¢«ç§°ä¸ºç ç‚¹(code point)ã€‚ç ç‚¹ä»¥ U+hex çš„å½¢å¼è¡¨ç¤ºï¼ŒU+æ˜¯ä»£è¡¨Unicodeçš„å‰ç¼€ï¼Œè€Œ hex æ˜¯ä¸€ä¸ª16è¿›åˆ¶æ•°ã€‚å–å€¼èŒƒå›´æ˜¯ä»Ž U+0000 åˆ° U+10FFFFã€‚

æ¯ä¸ªç ç‚¹å¯¹åº”ä¸€ä¸ªå­—ç¬¦ï¼Œç»å¤§éƒ¨åˆ†çš„å¸¸è§å­—ç¬¦åœ¨æœ€å‰é¢çš„ 65536 ä¸ªå­—ç¬¦ï¼ŒèŒƒå›´æ˜¯ U+0000åˆ°U+FFFFã€‚ ä¸€èˆ¬æ±‰å­—çš„ç ç‚¹åŒºé—´ä¸º U+2E80 - U+9FFFã€‚

### å­—ç¬¦å¹³é¢

ç›®å‰çš„Unicodeåˆ†æˆäº†17ä¸ªç¼–ç»„ï¼Œä¹Ÿç§°å¹³é¢ï¼Œæ¯ä¸ªå¹³é¢æœ‰65536ä¸ªç ç‚¹ã€‚

- ç¬¬ä¸€ä¸ªå¹³é¢æ˜¯åŸºæœ¬å¤šè¯­è¨€å¹³é¢ï¼ŒèŒƒå›´ï¼šU+0000 - U+FFFFï¼Œå¤šæ•°å¸¸è§å­—ç¬¦éƒ½åœ¨è¯¥åŒºé—´ã€‚
- å…¶ä»–å¹³é¢åˆ™ä¸ºè¾…åŠ©å¹³é¢ï¼ŒèŒƒå›´ï¼šU+10000 åˆ° U+10FFFFï¼Œå¦‚æˆ‘ä»¬åœ¨ç½‘ä¸Šå¸¸è§ Emoji è¡¨æƒ…ã€‚

### ç å…ƒ

ç å…ƒ(Code Unit)å¯ä»¥ç†è§£ä¸ºå¯¹ç ç‚¹è¿›è¡Œç¼–ç æ—¶çš„æœ€å°åŸºæœ¬å•å…ƒï¼Œè§„å®šè®¡ç®—æœºåº”è¯¥å¦‚ä½•å­˜å‚¨è¿™ä¸ªç ç‚¹ã€‚è€Œå­—ç¬¦ç¼–ç çš„ä½œç”¨å°±æ˜¯å°†Unicode ç ç‚¹è½¬æ¢æˆç å…ƒåºåˆ—ã€‚ Unicodeå¸¸ç”¨çš„ç¼–ç æ–¹å¼æœ‰ UTF-8 ã€UTF-16 å’Œ UTF-32ï¼ŒUTFæ˜¯Unicode TransferFormatçš„ç¼©å†™ã€‚UTF-8æ˜¯8ä½çš„å•å­—èŠ‚ç å…ƒï¼ŒUTF-16æ˜¯16ä½çš„åŒå­—èŠ‚ç å…ƒï¼ŒUTF-32æ˜¯32ä½çš„å››å­—èŠ‚ç å…ƒã€‚

#### UTF-16

javascriptä¸­çš„å­—ç¬¦ä¸²æ˜¯åŸºäºŽUTF-16ç¼–ç çš„ï¼Œå­—ç¬¦ä¸²çš„lengthå±žæ€§ï¼Œå®žé™…ä¸Šæ˜¯ä½¿ç”¨UTF-16çš„ç å…ƒä¸ªæ•°æ¥è¿›è¡Œè®¡ç®—çš„ï¼š

- ASCIIç å’Œå¤§éƒ¨åˆ†ä¸­æ–‡ï¼Œéƒ½æ˜¯ä¸€ä¸ªç å…ƒ
- è€Œè¡¨æƒ…å­—ç¬¦å’Œå…¶ä»–ç‰¹æ®Šå­—ç¬¦éƒ½æ˜¯ä¸¤ä¸ªç å…ƒ

å…·ä½“ç¼–ç è§„åˆ™ï¼š

- åŸºæœ¬å¤šè¯­è¨€å¹³é¢ï¼š
  - ç ç‚¹å°äºŽU+FFFFï¼ŒåŸºæœ¬å­—ç¬¦ï¼Œä¸éœ€å¤„ç†ï¼Œç›´æŽ¥ä½¿ç”¨ï¼Œå ä¸¤ä¸ªå­—èŠ‚
  - åœ¨UnicodeåŸºæœ¬å¤šè¯­è¨€å¹³é¢å†…ï¼Œä»ŽU+D800åˆ°U+DFFFä¹‹é—´çš„ç ç‚¹åŒºé—´æ˜¯ä¸å¯¹åº”å­—ç¬¦çš„ï¼ŒUTF-16éœ€è¦åˆ©ç”¨è¿™å—ç ä½æ¥å¯¹è¾…åŠ©å¹³é¢çš„å­—ç¬¦è¿›è¡Œç¼–ç ã€‚
- è¾…åŠ©å¹³é¢ï¼šæ‹†åˆ†æˆä¸¤ä¸ªç å…ƒï¼Œå››ä¸ªå­—èŠ‚ï¼Œcpè¡¨ç¤ºç ç‚¹ï¼š
  - ä½Žä½â€”â€”((cp - 65536) / 1024) + 0xD800ï¼Œå€¼èŒƒå›´æ˜¯ 0xD800~0xDBFFï¼›
  - é«˜ä½â€”â€”((cp - 65536) % 1024) + 0xDC00ï¼Œå€¼èŒƒå›´æ˜¯ 0xDC00~0xDFFF

```JavaScript
æ±‰å­—:
'å¥½'.codePointAt() // 22909ï¼Œç ç‚¹å°äºŽU+FFFFï¼Œç›´æŽ¥è¿›è¡Œåå…­è¿›åˆ¶è½¬æ¢ï¼š579D

è¡¨æƒ…ç¬¦å· 
'ðŸ˜„'.codePointAt() 
// 128516ï¼Œç ç‚¹éœ€è¦æ‹†åˆ†ï¼š
// ä½Žä½ï¼šMath.floor(((128516 - 65536) / 1024)) + 0xD800 // 55357, å¾—åˆ° D83D
// é«˜ä½ï¼š((128516 - 65536) % 1024) + 0xDC00 // 56836ï¼Œå¾—åˆ° DE04
```

## Emoji

#### ä¸ºä»€ä¹ˆä¸åŒ emoji çš„é•¿åº¦ä¸ä¸€æ ·å‘¢ï¼Ÿ

```JavaScript
'ðŸ˜Š'.length // 2
'ðŸ¤”ï¸'.length // 3
'ðŸ¤¦ðŸ»â™‚ï¸'.length // 7
```

- å…ˆå¯¹ emoji æ‹†è§£ä¸€ä¸‹

```JavaScript
[...'ðŸ˜Š'] // ['ðŸ˜Š']

[...'ðŸ¤”ï¸'] 
// ['ðŸ¤”', 'ï¸'] 
// 'ï¸'.length === 1

[...'ðŸ¤¦ðŸ»â™‚ï¸'] 
// ['ðŸ¤¦', 'ðŸ»', '', 'â™‚', 'ï¸']
```

![img](https://bytedance.sg.larkoffice.com/space/api/box/stream/download/asynccode/?code=MGRkMjMzMjE3YmY2MjFhZDcxZjQxZDZmMDg5MjE1NzVfdTRVS0YzNlR5dE83RExDN1lSbXdSMFdVS3ZtMlljbkZfVG9rZW46U1NvdWIwbDhUb0dkd0Z4WHdUMGNHWnBmbldkXzE3MTg5NDg3NjI6MTcxODk1MjM2Ml9WNA)

- è¿™äº›é•¿åº¦ä¸º 1 çš„ç©ºå­—ç¬¦æ˜¯ä»€ä¹ˆå‘¢

```JavaScript
'ðŸ¤”ï¸'.charCodeAt(2).toString(16) // 'fe0f'

'ðŸ¤¦ðŸ»â™‚ï¸'.charCodeAt(4).toString(16) // 200d
'ðŸ¤¦ðŸ»â™‚ï¸'.charCodeAt(6).toString(16) // 'fe0f'
```

Unicode æœ‰ä¸€äº›éžæ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åœ¨å¤§å¤šæ•°æ–‡æœ¬ç¼–è¾‘å™¨æˆ–æ˜¾ç¤ºå™¨ä¸­ï¼Œæ˜¯å¯èƒ½æ— æ³•ç›´è§‚åœ°çœ‹åˆ°å®ƒä»¬çš„ã€‚

1. U+200Dï¼šé›¶å®½è¿žæŽ¥ç¬¦ï¼ˆZero-width joiner)ï¼Œå®ƒå¯ä»¥ä½¿ä¸¤ä¸ªæœ¬ä¸ä¼šå‘ç”Ÿè¿žå­—çš„å­—ç¬¦äº§ç”Ÿè¿žå­—æ•ˆæžœã€‚å½“è¢«æ”¾åœ¨ä¸¤ä¸ªemojiä¹‹é—´æ—¶ï¼Œå¯ä»¥è®©å®ƒæˆä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦ã€‚
   1.  é›¶å®½å­—ç¬¦æ˜¯ä¸€ç§ç‰¹æ®Šçš„ Unicode å­—ç¬¦ï¼Œå®ƒæ²¡æœ‰å¯è§†åŒ–è¡¨çŽ°ï¼Œä¹Ÿå°±æ˜¯åœ¨æ–‡æœ¬ä¸­ä¸å ç”¨ä»»ä½•ç©ºé—´ã€‚å¸¸è§çš„é›¶å®½å­—ç¬¦æœ‰é›¶å®½ç©ºæ ¼ï¼ˆZero-width space, U+200Bï¼‰å’Œé›¶å®½è¿žæŽ¥ç¬¦ï¼ˆZero-width joiner, U+200Dï¼‰ç­‰ã€‚è¿™äº›å­—ç¬¦å¸¸å¸¸ç”¨äºŽæŽ§åˆ¶å­—ç¬¦çš„é—´éš”å’Œè”ç»“ï¼Œä½†åœ¨æ­£å¸¸é˜…è¯»ä¸­æ˜¯ä¸å¯è§çš„ã€‚
2. U+FE0Fï¼šå˜ä½“é€‰æ‹©ç¬¦ï¼Œæ˜¯ä¸€ç§å¯ä»¥æ”¹å˜å‰ä¸€ä¸ªå­—ç¬¦æ˜¾ç¤ºæ ·å¼çš„ Unicode å­—ç¬¦ã€‚å½“å®ƒè·Ÿéšåœ¨æŸäº›å­—ç¬¦åŽé¢æ—¶ï¼Œå¯ä»¥å°†è¿™äº›å­—ç¬¦æ˜¾ç¤ºä¸º emoji æ ·å¼ã€‚

#### æ€Žä¹ˆå°† emoji çš„é•¿åº¦ä½œä¸º 1 è®¡ç®— length

https://www.npmjs.com/package/runes?activeTab=readme

```JavaScript
'hello ðŸ˜Š'.length // 8
=> 
['h','e','l', 'l', 'o', ' ', 'ðŸ˜Š'].length // 7
```

## Unicode in ES2018

https://github.com/tc39/proposal-regexp-unicode-property-escapes